<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Alcoding Club | Editorials</title><link rel="stylesheet" href="https://bootswatch.com/4/lux/bootstrap.min.css"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/4e68258e72c34aac27c5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4e68258e72c34aac27c5.css"/><link rel="preload" href="/_next/static/H6-RC2pVIyAi_zQ7xQ-XP/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/H6-RC2pVIyAi_zQ7xQ-XP/pages/problems/%5Bid%5D.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.c6faae2799416a6da8e8.js" as="script"/><link rel="preload" href="/_next/static/chunks/02387e395e7e5d2210ca6c3e7ce6d6d13189610c.f739c2b8f4ba7856803e.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-bf21b3ebcc6f71719528.js" as="script"/></head><body><div id="__next"><div><nav class="navbar navbar-expand-lg navbar-light bg-light"><a class="navbar-brand" href="#">Editorials</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarColor03"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a></li></ul></div></nav><div class="container"><div class="jumbotron"><h3>Editorial</h3><div>
</div></div><select id="languageSelector"><option value="py">Python</option></select><pre style="display:block;overflow-x:auto;padding:0.5em;background:#F0F0F0;color:#444"><code></code></pre></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"editorialData":{"editorial":"\n","solutions":{"py":"typeOfStation = []\ngraph = []\ndepth = []\nvisited = []\nparent = []\ndistanceFromParent = []\n\ndef findPath(a, b):\n\n    global depth, parent, visited, distanceFromParent\n\n    pathA = [a]\n    pathB = [b]\n\n    while (a != b):\n        if depth[a] \u003e depth[b]:\n            pathA.append(parent[a])\n            a = parent[a]\n\n        elif depth[b] \u003e depth[a]:\n            pathB.append(parent[b])\n            b = parent[b]\n\n        else:\n            pathA.append(parent[a])\n            pathB.append(parent[b])\n            a = parent[a]\n            b = parent[b]\n\n    pathB = pathB[::-1]\n\n    return (pathA + pathB[1:], a)\n    \n\ndef bfs(root):\n\n    global depth, parent, visited, distanceFromParent\n\n    depth[root] = 0\n    parent[root] = -1\n    visited[root] = 1\n    distanceFromParent[root] = 0\n\n    queue = [root]\n\n    while queue:\n        s = queue.pop()\n\n        for node in graph[s]:\n            neighbour = node[0]\n            if visited[neighbour] == 0:\n                visited[neighbour] = 1\n                queue.append(neighbour)\n                depth[neighbour] = depth[s] + 1\n                parent[neighbour] = s\n                distanceFromParent[neighbour] = node[1]\n    \n\ndef calculate(path, lca):\n\n    global depth, parent, visited, distanceFromParent\n\n    cost = 0\n    distance = 0\n\n    a = path[0]\n    b = path[-1]\n\n    if a == b:\n        return 0\n\n    check = (a != lca)\n\n    while check:\n\n        if (typeOfStation[a] and distance \u003e 0):\n            cost += 2 ** (distance)\n            distance = 0\n        \n        if a == lca:\n            check  = 0\n        else:\n            distance += distanceFromParent[a]\n            a = parent[a]\n\n    check = (a != lca)\n\n    while b != lca:\n\n        if (typeOfStation[b] and distance \u003e 0):\n            cost += 2 ** (distance)\n            distance = 0\n\n        if b == lca:\n            check = 0\n        else:\n            distance += distanceFromParent[b]\n            b = parent[b]\n\n    if distance:\n        cost += 2 ** distance\n\n    return cost\n\nfor _ in range(int(input())):\n\n    graph = []\n    depth = []\n    visited = []\n    parent = []\n    typeOfStation = []\n    distanceFromParent = []\n\n    n, q, c = list(map(int, input().split(' ')))\n    typeOfStation = list(map(int, input().split(' ')))\n\n    graph = [[] for i in range(n)]\n\n    for i in range(n-1):\n        u, v, d = list(map(int, input().split(' ')))\n        graph[u-1].append([v-1, d])\n        graph[v-1].append([u-1, d])\n\n    depth = [-1 for i in range(n)]\n    visited = [0 for i in range(n)]\n    parent = [-1 for i in range(n)]\n    distanceFromParent = [0 for i in range(n)]\n\n    bfs(c - 1)\n\n    for i in range(q):\n        a, b = list(map(int, input().split(' ')))\n        path, lca = findPath(a-1, b-1)\n        ans = calculate(path, lca)\n        print(ans)"}}},"__N_SSG":true},"page":"/problems/[id]","query":{"id":"MARS1"},"buildId":"H6-RC2pVIyAi_zQ7xQ-XP","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-f1a72475392243fcf9b5.js"></script><script async="" data-next-page="/_app" src="/_next/static/H6-RC2pVIyAi_zQ7xQ-XP/pages/_app.js"></script><script async="" data-next-page="/problems/[id]" src="/_next/static/H6-RC2pVIyAi_zQ7xQ-XP/pages/problems/%5Bid%5D.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.c6faae2799416a6da8e8.js" async=""></script><script src="/_next/static/chunks/02387e395e7e5d2210ca6c3e7ce6d6d13189610c.f739c2b8f4ba7856803e.js" async=""></script><script src="/_next/static/runtime/main-bf21b3ebcc6f71719528.js" async=""></script><script src="/_next/static/H6-RC2pVIyAi_zQ7xQ-XP/_buildManifest.js" async=""></script><script src="/_next/static/H6-RC2pVIyAi_zQ7xQ-XP/_ssgManifest.js" async=""></script></body></html>